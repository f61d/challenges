from Crypto.Util.number import getPrime, bytes_to_long
import gmpy2,random
from secret import flag


def gen():
    while True:
        g = getPrime(500)
        a = b = 0
        while not gmpy2.is_prime(2*g*a+1):
            a = random.randint(2**523, 2**524)
        while not gmpy2.is_prime(2*g*b+1):
            b = random.randint(2**523, 2**524)
        h = 2*g*a*b+a+b
        if gmpy2.is_prime(h):
            p = 2*g*a+1
            q = 2*g*b+1
            return p*q, g
    

N,g = gen()
# N = 67962725468240199924103144864951334845750492508509360358636648068909779932072313362607631417524914992411826230276465100489023746209605790020210412575433464887238013738989770872867041592441153421617243161413094177629581581728221687772551567927241071007480087793370382177952900925657974338348428988433092737432689512506966089398873760401212521089061934975582692308605433023613521500237258699626587149952370997420510392932840377408736864097301789914658244266522930092113493152991783027162871212338968297436073316959569822974289536559300512091342692975133379473145882007983357289924135373382264527866381118893476257705939L
# g = 3235645591686044532495326878291617484542045511433360748778013933565021819649890342389737893735574764418484922895778834144345295691799766302763199373647L
e = 65537
m = bytes_to_long(flag)
c = pow(m, e, N)
# c = 7918937034819399210460701361082120267249016865135589044938397478179178418982216265766430882604707450651405790878761026681351233717846491757101684210544361607883043938000941498442897699091016071609425252346011280078699567193949155766516051130050592046343488075564740812480634431357869210712013396437065989799117830247228129120071415956115563715118301273810713118159274551107354918579047901176471910532333125717712607469726900731370186233984133546278420585661042017307325998441634272568791745798269084955686428143476025911093137683806174746625559312685862694783475952178855060639359433340135424849663386199035593137765L
